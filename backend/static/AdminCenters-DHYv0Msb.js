import{d as $,a as x,s as L,r as R,b as s,o as V,c as I,f as e,w as o,e as l,y as C,F as j,x as G,h as d,a1 as H,A,E as m,R as J,p as K,m as O,_ as D}from"./index-BKtHripP.js";import{p as Q,_ as W}from"./NavigatorM.vue_vue_type_script_setup_true_lang-vNEzk7W2.js";const X=c=>(K("data-v-e22a76d5"),c=c(),O(),c),Y={class:"personal-center"},Z=X(()=>l("div",{class:"card-header"},[l("span",null,"查看您的信息")],-1)),ee={class:"info-content"},oe={class:"avatar-section"},se={class:"user-details"},ae={class:"card-footer"},ne={class:"dialog-footer"},te=$({__name:"AdminCenter",props:["username"],setup(c){const f=H(),i=c,u=x({name:i.username,avatar:"path_to_avatar_image",studentId:"22371500",role:"Admin",email:"22371500@buaa.edu.cn",createdAt:"2024-02-19",currentCourse:"2024春-操作系统"}),w={studentId:i.username,role:u.role},h={studentId:"el-icon-user",role:"el-icon-s-custom"},_={studentId:"用户名",role:"用户身份"};L(async()=>E());function E(){u.avatar=Q}const F=()=>{A.post("/user_logout",{username:i.username},{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(r){r.data.code===200?(console.log("退！"),m.success("退出成功！"),setTimeout(()=>{f.push("/login")},1e3)):console.log("Failed to logout:",r.data.message)}).catch(function(){console.log("error")})},p=R(!1),a=x({oldPassword:"",newPassword:"",confirmPassword:""}),M=()=>{p.value=!0},S=()=>{if(console.log("修改密码",a),a.newPassword!==a.confirmPassword){m.error("新密码和确认密码不一致");return}A.post("/user_change_password",{username:i.username,password:a.oldPassword,new_password:a.newPassword,usertype:"0"},{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(r=>{r.data.code===200?(m.success("密码修改成功"),p.value=!1):m.error("密码修改失败: "+r.data.message)}).catch(r=>{console.error("Error:",r),m.error("密码修改失败，请稍后重试")})};return(r,n)=>{const T=s("el-avatar"),U=s("el-upload"),b=s("el-col"),B=s("el-row"),v=s("el-link"),N=s("el-card"),g=s("el-input"),y=s("el-form-item"),q=s("el-form"),k=s("el-button"),z=s("el-dialog");return V(),I("div",Y,[e(N,{class:"info-card"},{header:o(()=>[Z]),default:o(()=>[l("div",ee,[l("div",oe,[e(T,{size:100,src:u.avatar},null,8,["src"]),l("h2",null,C(u.name),1),e(U,{class:"avatar-uploader",action:"#","show-file-list":!1,"auto-upload":!1,accept:".jpg,.png"})]),l("div",se,[(V(),I(j,null,G(w,(t,P)=>e(B,{class:"info-row",key:P},{default:o(()=>[e(b,{span:8,class:"info-label"},{default:o(()=>[l("i",{class:J(h[P])},null,2),d(" "+C(_[P]),1)]),_:2},1024),e(b,{span:16,class:"info-value"},{default:o(()=>[d(C(t),1)]),_:2},1024)]),_:2},1024)),64))])]),l("div",ae,[e(v,{type:"danger",class:"footer-link"},{default:o(()=>[d("* 若您的个人信息有误，请联系系统管理员")]),_:1}),l("div",null,[e(v,{type:"primary",class:"footer-link",onClick:M},{default:o(()=>[d("修改密码")]),_:1}),e(v,{type:"primary",class:"footer-link",onClick:F},{default:o(()=>[d("退出登录")]),_:1})])])]),_:1}),e(z,{title:"修改密码",modelValue:p.value,"onUpdate:modelValue":n[4]||(n[4]=t=>p.value=t),width:"30%","close-on-click-modal":!1},{footer:o(()=>[l("span",ne,[e(k,{type:"primary",onClick:S},{default:o(()=>[d("确认修改")]),_:1}),e(k,{onClick:n[3]||(n[3]=t=>p.value=!1)},{default:o(()=>[d("取消修改")]),_:1})])]),default:o(()=>[e(q,{model:a,"label-width":"80px"},{default:o(()=>[e(y,{label:"旧密码"},{default:o(()=>[e(g,{modelValue:a.oldPassword,"onUpdate:modelValue":n[0]||(n[0]=t=>a.oldPassword=t),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),e(y,{label:"新密码"},{default:o(()=>[e(g,{modelValue:a.newPassword,"onUpdate:modelValue":n[1]||(n[1]=t=>a.newPassword=t),type:"password","show-password":""},null,8,["modelValue"])]),_:1}),e(y,{label:"确认密码"},{default:o(()=>[e(g,{modelValue:a.confirmPassword,"onUpdate:modelValue":n[2]||(n[2]=t=>a.confirmPassword=t),type:"password","show-password":""},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),le=D(te,[["__scopeId","data-v-e22a76d5"]]),re={class:"common-layout"},de=$({__name:"AdminCenters",setup(c){return(f,i)=>{const u=s("el-header"),w=s("el-aside"),h=s("el-main"),_=s("el-container");return V(),I("div",re,[e(_,null,{default:o(()=>[e(u),e(_,null,{default:o(()=>[e(w,{width:"200px"},{default:o(()=>[e(W,{username:f.$route.query.username},null,8,["username"])]),_:1}),e(_,null,{default:o(()=>[e(h,{class:"shifted-content"},{default:o(()=>[e(le,{username:f.$route.query.username},null,8,["username"])]),_:1})]),_:1})]),_:1})]),_:1})])}}}),ie=D(de,[["__scopeId","data-v-e2f04925"]]);export{ie as default};
