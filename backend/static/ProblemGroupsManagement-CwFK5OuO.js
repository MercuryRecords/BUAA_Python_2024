import{_ as ne}from"./NavigatorM.vue_vue_type_script_setup_true_lang-vNEzk7W2.js";import{d as N,r as i,a as q,q as se,s as re,A as U,E as s,b as n,o as L,c as A,e as _,f as e,w as a,y as E,u as B,h as b,T as ue,a0 as de,V as ie,X as pe,p as me,m as ce,_ as F}from"./index-BKtHripP.js";const _e=w=>(me("data-v-236bbe0e"),w=w(),ce(),w),fe={class:"problem-set-container"},ve={class:"problem-set"},be={class:"header-content"},ge={class:"filter-info"},Ve={class:"search-container",style:{"margin-top":"5px"}},we={class:"button-container"},ye=_e(()=>_("span",null,"Delete",-1)),he={class:"dialog-footer"},Ce={class:"dialog-footer"},xe={class:"dialog-footer"},Pe=N({__name:"ProblemGroups",props:["username"],setup(w){const C=i("practice"),V=i(1),g=i(20),p=i(0),y=w,m=q([]),$=q([]),j=se(()=>{const t=(V.value-1)*g.value,l=t+g.value;return m.slice(t,l)}),k=i(!1),x=i(!1),G=i(!1),z=i(""),f=i({username:"",title:"",description:"",tag:[]}),r=i({username:"",problem_group_id:0,title:"",description:""}),c=i({username:"",problem_group_id:0,group_name:"",permission:0});re(()=>{T()});const T=async()=>{try{const t=await U.post("/admin_get_problem_groups",{username:y.username,mode:0,filter_group:""},{headers:{"Content-Type":"application/x-www-form-urlencoded"}});if(console.log(t.data),t.data.code===200){m.length=0,$.length=0;for(let l=0;l<t.data.data.length;l++)m.push(t.data.data[l]),$.push(t.data.data[l]);p.value=t.data.data.length,p.value=t.data.total||t.data.data.length}}catch(t){console.error("获取题单列表失败:",t),s.error("获取题单列表失败，请重试")}},K=t=>{g.value=t,V.value=1},X=t=>{V.value=t},H=async()=>{try{console.log(f.value);const t=await U.post("/problem_group_create",f.value,{headers:{"Content-Type":"application/x-www-form-urlencoded"}});t.data.code===200?(s.success("新题单创建成功"),k.value=!1,p.value++,m.length>=g.value&&(V.value=Math.ceil(p.value/g.value)),await T()):(console.log(t.data.code),s.error("题单创建失败"))}catch(t){console.error("题单创建失败:",t),s.error("题单创建失败，请重试")}},J=t=>{x.value=!0,r.value={username:y.username,problem_group_id:t.id,title:t.name,description:t.description||""}},O=async()=>{try{(await U.post("/admin_problem_group_update",r.value,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})).data.code===200?(s.success("题单更新成功"),x.value=!1,T()):s.error("题单更新失败")}catch(t){console.error("题单更新失败:",t),s.error("题单更新失败，请重试")}},Q=async()=>{try{(await U.post("/problem_share",c.value,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})).data.code===200?(s.success("题单分享成功"),G.value=!1):s.error("题单分享失败")}catch(t){console.error("题单分享失败:",t),s.error("题单分享失败，请重试")}},R=async t=>{try{await ue.confirm("确定要删除这个题单吗？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),(await U.post("/admin_problem_group_delete",{username:y.username,problem_group_id:t.id},{headers:{"Content-Type":"application/x-www-form-urlencoded"}})).data.code===200?(s.success("题单删除成功"),p.value--,await T()):s.error("题单删除失败")}catch(l){l!=="cancel"&&(console.error("题单删除失败:",l),s.error("题单删除失败，请重试"))}},W=()=>{const t=z.value.toLowerCase(),l=$.filter(h=>h.id.toString().includes(t)||h.title.toLowerCase().includes(t)||h.creator&&h.creator.toLowerCase().includes(t));m.length=0,m.push(...l),p.value=l.length,V.value=1};return(t,l)=>{const h=n("el-tab-pane"),Y=n("el-tabs"),u=n("el-input"),I=n("el-icon"),v=n("el-button"),Z=n("el-card"),P=n("el-table-column"),ee=n("router-link"),le=n("el-table"),ae=n("el-pagination"),d=n("el-form-item"),S=n("el-form"),D=n("el-dialog"),M=n("el-option"),oe=n("el-select");return L(),A("div",fe,[_("div",ve,[e(Z,{class:"filter-card"},{default:a(()=>[_("div",be,[e(Y,{modelValue:C.value,"onUpdate:modelValue":l[0]||(l[0]=o=>C.value=o)},{default:a(()=>[e(h,{label:"练习题单",name:"practice"})]),_:1},8,["modelValue"])]),_("div",ge,[_("span",null,"共计 "+E(p.value)+" 个题单",1),_("div",Ve,[e(u,{modelValue:z.value,"onUpdate:modelValue":l[1]||(l[1]=o=>z.value=o),placeholder:"搜索编号、名称或创建者",class:"search-input",style:{width:"200px"}},null,8,["modelValue"]),e(v,{type:"primary",onClick:W,style:{"margin-left":"10px"}},{default:a(()=>[e(I,null,{default:a(()=>[e(B(de))]),_:1}),b(" 搜索 ")]),_:1})])])]),_:1}),e(le,{data:j.value,style:{width:"100%"},"default-sort":{prop:"id",order:"ascending"}},{default:a(()=>[e(P,{prop:"id",label:"编号",width:"80",sortable:""}),e(P,{label:"名称",width:"300"},{default:a(o=>[e(ee,{to:{name:"adminSheet",query:{username:y.username,sheetId:o.row.id}},class:"problem-link"},{default:a(()=>[b(E(o.row.title),1)]),_:2},1032,["to"])]),_:1}),e(P,{prop:"creator",label:"创建者",width:"200"}),e(P,{prop:"problem_num",label:"题目数量",width:"320",sortable:""}),e(P,{label:"操作",width:"300"},{default:a(o=>[_("div",we,[e(v,{size:"small",onClick:te=>J(o.row)},{default:a(()=>[e(I,null,{default:a(()=>[e(B(ie))]),_:1}),b(" Update ")]),_:2},1032,["onClick"]),e(v,{size:"small",type:"danger",onClick:te=>R(o.row)},{default:a(()=>[e(I,null,{default:a(()=>[e(B(pe))]),_:1}),ye]),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["data"]),e(ae,{class:"pages",onSizeChange:K,onCurrentChange:X,"current-page":V.value,"page-sizes":[20,50,100],"page-size":g.value,layout:"total, sizes, jumper, ->, prev, pager, next",total:p.value},null,8,["current-page","page-size","total"])]),e(D,{modelValue:k.value,"onUpdate:modelValue":l[6]||(l[6]=o=>k.value=o),title:"新建题单",width:"30%"},{footer:a(()=>[_("span",he,[e(v,{type:"primary",onClick:H},{default:a(()=>[b("确定")]),_:1}),e(v,{onClick:l[5]||(l[5]=o=>k.value=!1)},{default:a(()=>[b("取消")]),_:1})])]),default:a(()=>[e(S,{model:f.value,"label-width":"100px"},{default:a(()=>[e(d,{label:"用户名"},{default:a(()=>[e(u,{modelValue:f.value.username,"onUpdate:modelValue":l[2]||(l[2]=o=>f.value.username=o),disabled:""},null,8,["modelValue"])]),_:1}),e(d,{label:"题单标题"},{default:a(()=>[e(u,{modelValue:f.value.title,"onUpdate:modelValue":l[3]||(l[3]=o=>f.value.title=o)},null,8,["modelValue"])]),_:1}),e(d,{label:"题单描述"},{default:a(()=>[e(u,{modelValue:f.value.description,"onUpdate:modelValue":l[4]||(l[4]=o=>f.value.description=o),type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e(D,{modelValue:x.value,"onUpdate:modelValue":l[12]||(l[12]=o=>x.value=o),title:"更新题单",width:"30%"},{footer:a(()=>[_("span",Ce,[e(v,{type:"primary",onClick:O},{default:a(()=>[b("确定")]),_:1}),e(v,{onClick:l[11]||(l[11]=o=>x.value=!1)},{default:a(()=>[b("取消")]),_:1})])]),default:a(()=>[e(S,{model:r.value,"label-width":"100px"},{default:a(()=>[e(d,{label:"用户名"},{default:a(()=>[e(u,{modelValue:r.value.username,"onUpdate:modelValue":l[7]||(l[7]=o=>r.value.username=o),disabled:""},null,8,["modelValue"])]),_:1}),e(d,{label:"题单ID"},{default:a(()=>[e(u,{modelValue:r.value.problem_group_id,"onUpdate:modelValue":l[8]||(l[8]=o=>r.value.problem_group_id=o),disabled:""},null,8,["modelValue"])]),_:1}),e(d,{label:"题单标题"},{default:a(()=>[e(u,{modelValue:r.value.title,"onUpdate:modelValue":l[9]||(l[9]=o=>r.value.title=o)},null,8,["modelValue"])]),_:1}),e(d,{label:"题单描述"},{default:a(()=>[e(u,{modelValue:r.value.description,"onUpdate:modelValue":l[10]||(l[10]=o=>r.value.description=o),type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e(D,{modelValue:G.value,"onUpdate:modelValue":l[18]||(l[18]=o=>G.value=o),title:"分享题单",width:"40%"},{footer:a(()=>[_("span",xe,[e(v,{type:"primary",onClick:Q},{default:a(()=>[b("分享")]),_:1}),e(v,{onClick:l[17]||(l[17]=o=>G.value=!1)},{default:a(()=>[b("取消")]),_:1})])]),default:a(()=>[e(S,{model:c.value,"label-width":"100px"},{default:a(()=>[e(d,{label:"用户名"},{default:a(()=>[e(u,{modelValue:c.value.username,"onUpdate:modelValue":l[13]||(l[13]=o=>c.value.username=o),disabled:""},null,8,["modelValue"])]),_:1}),e(d,{label:"题单ID"},{default:a(()=>[e(u,{modelValue:c.value.problem_group_id,"onUpdate:modelValue":l[14]||(l[14]=o=>c.value.problem_group_id=o),disabled:""},null,8,["modelValue"])]),_:1}),e(d,{label:"分享目标群组"},{default:a(()=>[e(u,{modelValue:c.value.group_name,"onUpdate:modelValue":l[15]||(l[15]=o=>c.value.group_name=o)},null,8,["modelValue"])]),_:1}),e(d,{label:"权限"},{default:a(()=>[e(oe,{modelValue:c.value.permission,"onUpdate:modelValue":l[16]||(l[16]=o=>c.value.permission=o)},{default:a(()=>[e(M,{value:0,label:"仅查看"}),e(M,{value:1,label:"可查看并修改"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),Ue=F(Pe,[["__scopeId","data-v-236bbe0e"]]),ke={class:"common-layout"},Ge=N({__name:"ProblemGroupsManagement",setup(w){return(C,V)=>{const g=n("el-header"),p=n("el-aside"),y=n("el-main"),m=n("el-container");return L(),A("div",ke,[e(m,null,{default:a(()=>[e(g),e(m,null,{default:a(()=>[e(p,{width:"200px"},{default:a(()=>[e(ne,{username:C.$route.query.username},null,8,["username"])]),_:1}),e(m,null,{default:a(()=>[e(y,{class:"shifted-content"},{default:a(()=>[e(Ue,{username:C.$route.query.username},null,8,["username"])]),_:1})]),_:1})]),_:1})]),_:1})])}}}),ze=F(Ge,[["__scopeId","data-v-18c800f3"]]);export{ze as default};
