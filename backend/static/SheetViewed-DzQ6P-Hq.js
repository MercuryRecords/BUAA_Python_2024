import{_ as se}from"./Navigator.vue_vue_type_script_setup_true_lang-Ce9qsQIy.js";import{d as N,r as i,a as E,q as re,s as ue,A as U,E as s,b as n,o as L,c as A,e as p,f as e,w as a,y as M,u as B,h as g,T as de,a0 as ie,W as pe,X as me,p as ce,m as _e,_ as F}from"./index-BKtHripP.js";const j=w=>(ce("data-v-8dfee683"),w=w(),_e(),w),fe={class:"problem-set-container"},ve={class:"problem-set"},be={class:"header-content"},ge={class:"filter-info"},Ve={class:"search-container",style:{"margin-top":"5px"}},we={class:"button-container"},he=j(()=>p("span",null,"Share",-1)),ye=j(()=>p("span",null,"Delete",-1)),Ce={class:"dialog-footer"},xe={class:"dialog-footer"},ke={class:"dialog-footer"},Ue=N({__name:"ViewSheet",props:["username"],setup(w){const C=i("practice"),V=i(1),b=i(20),m=i(0),h=w,c=E([]),$=E([]),K=re(()=>{const t=(V.value-1)*b.value,l=t+b.value;return c.slice(t,l)}),P=i(!1),S=i(!1),x=i(!1),z=i(""),f=i({username:"",title:"",description:"",tag:[]}),_=i({username:"",problem_group_id:0,title:"",description:""}),r=i({username:"",problem_group_id:0,group_name:"",permission:0});ue(()=>{T()});const T=async()=>{try{const t=await U.post("/get_problem_groups",{username:h.username,mode:0,filter_group:""},{headers:{"Content-Type":"application/x-www-form-urlencoded"}});if(console.log(t.data),t.data.code===200){c.length=0,$.length=0;for(let l=0;l<t.data.data.length;l++)c.push(t.data.data[l]),$.push(t.data.data[l]);m.value=t.data.data.length,m.value=t.data.total||t.data.data.length}}catch(t){console.error("获取题单列表失败:",t),s.error("获取题单列表失败，请重试")}},W=t=>{b.value=t,V.value=1},X=t=>{V.value=t},H=async()=>{try{console.log(f.value);const t=await U.post("/problem_group_create",f.value,{headers:{"Content-Type":"application/x-www-form-urlencoded"}});t.data.code===200?(s.success("新题单创建成功"),P.value=!1,m.value++,c.length>=b.value&&(V.value=Math.ceil(m.value/b.value)),await T()):(console.log(t.data.code),s.error("题单创建失败"))}catch(t){console.error("题单创建失败:",t),s.error("题单创建失败，请重试")}},J=async()=>{try{(await U.post("/problem_group_update",_.value,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})).data.code===200?(s.success("题单更新成功"),S.value=!1,T()):s.error("题单更新失败")}catch(t){console.error("题单更新失败:",t),s.error("题单更新失败，请重试")}},O=t=>{x.value=!0,r.value={username:h.username,problem_group_id:t.id,group_name:"",permission:0}},Q=async()=>{try{(await U.post("/problem_share",r.value,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})).data.code===200?(s.success("题单分享成功"),x.value=!1):s.error("题单分享失败")}catch(t){console.error("题单分享失败:",t),s.error("题单分享失败，请重试")}},R=async t=>{try{await de.confirm("确定要删除这个题单吗？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),(await U.post("/problem_group_delete",{username:h.username,problem_group_id:t.id},{headers:{"Content-Type":"application/x-www-form-urlencoded"}})).data.code===200?(s.success("题单删除成功"),m.value--,await T()):s.error("题单删除失败")}catch(l){l!=="cancel"&&(console.error("题单删除失败:",l),s.error("题单删除失败，请重试"))}},Y=()=>{const t=z.value.toLowerCase(),l=$.filter(y=>y.id.toString().includes(t)||y.title.toLowerCase().includes(t)||y.creator&&y.creator.toLowerCase().includes(t));c.length=0,c.push(...l),m.value=l.length,V.value=1};return(t,l)=>{const y=n("el-tab-pane"),Z=n("el-tabs"),u=n("el-input"),I=n("el-icon"),v=n("el-button"),ee=n("el-card"),k=n("el-table-column"),le=n("router-link"),ae=n("el-table"),oe=n("el-pagination"),d=n("el-form-item"),D=n("el-form"),G=n("el-dialog"),q=n("el-option"),te=n("el-select");return L(),A("div",fe,[p("div",ve,[e(ee,{class:"filter-card"},{default:a(()=>[p("div",be,[e(Z,{modelValue:C.value,"onUpdate:modelValue":l[0]||(l[0]=o=>C.value=o)},{default:a(()=>[e(y,{label:"练习题单",name:"practice"})]),_:1},8,["modelValue"])]),p("div",ge,[p("span",null,"共计 "+M(m.value)+" 个题单",1),p("div",Ve,[e(u,{modelValue:z.value,"onUpdate:modelValue":l[1]||(l[1]=o=>z.value=o),placeholder:"搜索编号、名称或创建者",class:"search-input",style:{width:"200px"}},null,8,["modelValue"]),e(v,{type:"primary",onClick:Y,style:{"margin-left":"10px"}},{default:a(()=>[e(I,null,{default:a(()=>[e(B(ie))]),_:1}),g(" 搜索 ")]),_:1})])])]),_:1}),e(ae,{data:K.value,style:{width:"100%"},"default-sort":{prop:"id",order:"ascending"}},{default:a(()=>[e(k,{prop:"id",label:"编号",width:"80",sortable:""}),e(k,{label:"名称",width:"300"},{default:a(o=>[e(le,{to:{name:"sheet",query:{username:h.username,sheetId:o.row.id}},class:"problem-link"},{default:a(()=>[g(M(o.row.title),1)]),_:2},1032,["to"])]),_:1}),e(k,{prop:"creator",label:"创建者",width:"200"}),e(k,{prop:"problem_num",label:"题目数量",width:"420",sortable:""}),e(k,{label:"操作",width:"300"},{default:a(o=>[p("div",we,[e(v,{size:"small",onClick:ne=>O(o.row)},{default:a(()=>[e(I,null,{default:a(()=>[e(B(pe))]),_:1}),he]),_:2},1032,["onClick"]),e(v,{size:"small",type:"danger",onClick:ne=>R(o.row)},{default:a(()=>[e(I,null,{default:a(()=>[e(B(me))]),_:1}),ye]),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["data"]),e(oe,{class:"pages",onSizeChange:W,onCurrentChange:X,"current-page":V.value,"page-sizes":[20,50,100],"page-size":b.value,layout:"total, sizes, jumper, ->,prev, pager, next",total:m.value},null,8,["current-page","page-size","total"])]),e(G,{modelValue:P.value,"onUpdate:modelValue":l[6]||(l[6]=o=>P.value=o),title:"新建题单",width:"30%"},{footer:a(()=>[p("span",Ce,[e(v,{type:"primary",onClick:H},{default:a(()=>[g("确定")]),_:1}),e(v,{onClick:l[5]||(l[5]=o=>P.value=!1)},{default:a(()=>[g("取消")]),_:1})])]),default:a(()=>[e(D,{model:f.value,"label-width":"100px"},{default:a(()=>[e(d,{label:"用户名"},{default:a(()=>[e(u,{modelValue:f.value.username,"onUpdate:modelValue":l[2]||(l[2]=o=>f.value.username=o),disabled:""},null,8,["modelValue"])]),_:1}),e(d,{label:"题单标题"},{default:a(()=>[e(u,{modelValue:f.value.title,"onUpdate:modelValue":l[3]||(l[3]=o=>f.value.title=o)},null,8,["modelValue"])]),_:1}),e(d,{label:"题单描述"},{default:a(()=>[e(u,{modelValue:f.value.description,"onUpdate:modelValue":l[4]||(l[4]=o=>f.value.description=o),type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e(G,{modelValue:S.value,"onUpdate:modelValue":l[12]||(l[12]=o=>S.value=o),title:"更新题单",width:"30%"},{footer:a(()=>[p("span",xe,[e(v,{type:"primary",onClick:J},{default:a(()=>[g("确定")]),_:1}),e(v,{onClick:l[11]||(l[11]=o=>S.value=!1)},{default:a(()=>[g("取消")]),_:1})])]),default:a(()=>[e(D,{model:_.value,"label-width":"100px"},{default:a(()=>[e(d,{label:"用户名"},{default:a(()=>[e(u,{modelValue:_.value.username,"onUpdate:modelValue":l[7]||(l[7]=o=>_.value.username=o),disabled:""},null,8,["modelValue"])]),_:1}),e(d,{label:"题单ID"},{default:a(()=>[e(u,{modelValue:_.value.problem_group_id,"onUpdate:modelValue":l[8]||(l[8]=o=>_.value.problem_group_id=o),disabled:""},null,8,["modelValue"])]),_:1}),e(d,{label:"题单标题"},{default:a(()=>[e(u,{modelValue:_.value.title,"onUpdate:modelValue":l[9]||(l[9]=o=>_.value.title=o)},null,8,["modelValue"])]),_:1}),e(d,{label:"题单描述"},{default:a(()=>[e(u,{modelValue:_.value.description,"onUpdate:modelValue":l[10]||(l[10]=o=>_.value.description=o),type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e(G,{modelValue:x.value,"onUpdate:modelValue":l[18]||(l[18]=o=>x.value=o),title:"分享题单",width:"40%"},{footer:a(()=>[p("span",ke,[e(v,{type:"primary",onClick:Q},{default:a(()=>[g("分享")]),_:1}),e(v,{onClick:l[17]||(l[17]=o=>x.value=!1)},{default:a(()=>[g("取消")]),_:1})])]),default:a(()=>[e(D,{model:r.value,"label-width":"100px"},{default:a(()=>[e(d,{label:"用户名"},{default:a(()=>[e(u,{modelValue:r.value.username,"onUpdate:modelValue":l[13]||(l[13]=o=>r.value.username=o),disabled:""},null,8,["modelValue"])]),_:1}),e(d,{label:"题单ID"},{default:a(()=>[e(u,{modelValue:r.value.problem_group_id,"onUpdate:modelValue":l[14]||(l[14]=o=>r.value.problem_group_id=o),disabled:""},null,8,["modelValue"])]),_:1}),e(d,{label:"分享目标群组"},{default:a(()=>[e(u,{modelValue:r.value.group_name,"onUpdate:modelValue":l[15]||(l[15]=o=>r.value.group_name=o)},null,8,["modelValue"])]),_:1}),e(d,{label:"权限"},{default:a(()=>[e(te,{modelValue:r.value.permission,"onUpdate:modelValue":l[16]||(l[16]=o=>r.value.permission=o)},{default:a(()=>[e(q,{value:0,label:"仅查看"}),e(q,{value:1,label:"可查看并修改"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),Pe=F(Ue,[["__scopeId","data-v-8dfee683"]]),Se={class:"common-layout"},Te=N({__name:"SheetViewed",setup(w){return(C,V)=>{const b=n("el-header"),m=n("el-aside"),h=n("el-main"),c=n("el-container");return L(),A("div",Se,[e(c,null,{default:a(()=>[e(b),e(c,null,{default:a(()=>[e(m,{width:"200px"},{default:a(()=>[e(se,{username:C.$route.query.username},null,8,["username"])]),_:1}),e(c,null,{default:a(()=>[e(h,{class:"shifted-content"},{default:a(()=>[e(Pe,{username:C.$route.query.username},null,8,["username"])]),_:1})]),_:1})]),_:1})]),_:1})])}}}),Ie=F(Te,[["__scopeId","data-v-f596f3b9"]]);export{Ie as default};
