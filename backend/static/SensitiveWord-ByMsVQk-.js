import{d as N,r as i,s as U,b as n,o as z,c as P,f as a,w as t,e as g,h as s,z as R,A as p,E as l,T as S,p as j,m as G,_ as H}from"./index-BKtHripP.js";import{_ as J}from"./NavigatorM.vue_vue_type_script_setup_true_lang-vNEzk7W2.js";const K=f=>(j("data-v-8a83527a"),f=f(),G(),f),L={class:"common-layout"},O={class:"sensitive-words-manager"},Q=K(()=>g("div",{class:"card-header"},[g("span",null,"敏感词管理")],-1)),X=N({__name:"SensitiveWord",setup(f){const u=R(),v=i(""),d=i("");i("");const w=i(!1),_=i(null),b=i([]),m=async()=>{p.post("/admin_get_sensitive_word_list",{username:u.query.username},{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(e){e.data.code===200?(console.log(e.data.data),b.value=e.data.data.map(o=>({word:o}))):l.error(e.data.message)}).catch(function(){console.log("error submit!")})};U(m);const V=async()=>{p.post("/admin_add_sensitive_words_by_list",{username:u.query.username,words:v.value.split(`
`).filter(e=>e.trim())},{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(async function(e){e.data.code===200?(w.value=!0,v.value="",await m(),l.success(e.data.message)):l.error(e.data.message)}).catch(function(){console.log("error submit!")})},k=e=>{e.raw?_.value=e.raw:_.value=null},B=async()=>{if(!_.value){l.warning("请选择文件");return}const e=new FormData;e.append("username",u.query.username),e.append("file",_.value),p.post("/admin_add_sensitive_words_by_txt_file",e,{headers:{"Content-Type":"multipart/form-data"}}).then(async function(o){o.data.code===200?(w.value=!0,_.value=null,await m(),l.success(o.data.message)):l.error(o.data.message)}).catch(function(){console.log("error submit!")})},x=async(e=d.value)=>{await S.confirm("确定要删除这个关键词吗？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),p.post("/admin_delete_sensitive_word",{username:u.query.username,word:e},{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(async function(o){o.data.code===200?(w.value=!0,d.value="",await m(),l.success(o.data.message)):l.error(o.data.message)}).catch(function(){console.log("error submit!")})},W=async()=>{try{await S.confirm("确定要清除所有敏感词吗？","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),p.post("/admin_clear_sensitive_word",{username:u.query.username},{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(async function(e){e.data.code===200?(w.value=!0,d.value="",await m(),l.success(e.data.message)):l.error(e.data.message)}).catch(function(){console.log("error submit!")})}catch{}};return(e,o)=>{const q=n("el-header"),I=n("el-aside"),C=n("el-input"),c=n("el-button"),A=n("el-divider"),E=n("el-upload"),y=n("el-tab-pane"),T=n("el-table-column"),$=n("el-table"),D=n("el-tabs"),F=n("el-card"),M=n("el-main"),h=n("el-container");return z(),P("div",L,[a(h,null,{default:t(()=>[a(q),a(h,null,{default:t(()=>[a(I,{width:"200px"},{default:t(()=>[a(J,{username:e.$route.query.username},null,8,["username"])]),_:1}),a(h,null,{default:t(()=>[a(M,{class:"shifted-content"},{default:t(()=>[g("div",O,[a(F,{class:"box-card"},{header:t(()=>[Q]),default:t(()=>[a(D,{type:"border-card"},{default:t(()=>[a(y,{label:"添加敏感词"},{default:t(()=>[a(C,{modelValue:v.value,"onUpdate:modelValue":o[0]||(o[0]=r=>v.value=r),type:"textarea",rows:5,placeholder:"请输入敏感词,每行一个"},null,8,["modelValue"]),a(c,{type:"primary",onClick:V,class:"mt-3"},{default:t(()=>[s("添加敏感词")]),_:1}),a(A,{"content-position":"center"},{default:t(()=>[s("或")]),_:1}),a(E,{class:"upload-demo",action:"#","on-change":k,"auto-upload":!1,accept:".txt"},{trigger:t(()=>[a(c,{type:"primary"},{default:t(()=>[s("选择文件")]),_:1})]),default:t(()=>[a(c,{class:"ml-3",type:"success",onClick:B},{default:t(()=>[s(" 上传并添加 ")]),_:1})]),_:1})]),_:1}),a(y,{label:"管理敏感词"},{default:t(()=>[a(C,{modelValue:d.value,"onUpdate:modelValue":o[2]||(o[2]=r=>d.value=r),placeholder:"请输入要删除的敏感词",class:"mb-3"},{append:t(()=>[a(c,{type:"danger",onClick:o[1]||(o[1]=r=>x(d.value))},{default:t(()=>[s("删除敏感词")]),_:1})]),_:1},8,["modelValue"]),a($,{data:b.value,style:{width:"100%"},"max-height":"400"},{default:t(()=>[a(T,{prop:"word",label:"敏感词"}),a(T,{fixed:"right",label:"操作",width:"120"},{default:t(r=>[a(c,{type:"danger",size:"small",onClick:Y=>x(r.row.word)},{default:t(()=>[s(" 删除 ")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),a(y,{label:"清除所有敏感词"},{default:t(()=>[a(c,{type:"danger",onClick:W},{default:t(()=>[s("清除所有敏感词")]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1})])}}}),ae=H(X,[["__scopeId","data-v-8a83527a"]]);export{ae as default};
