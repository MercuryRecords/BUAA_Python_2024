import{d as R,r as m,a as k,q as te,s as oe,A as x,E as g,b as u,o as C,c as j,f as e,w as a,e as v,u as n,h as r,S as le,y as $,g as N,C as z,n as ne,G as h,H as q,N as se,O as B,P as U,p as A,m as F,_ as K,R as re}from"./index-BKtHripP.js";import{_ as ue}from"./Navigator.vue_vue_type_script_setup_true_lang-Ce9qsQIy.js";const ce=c=>(A("data-v-eb5197d1"),c=c(),F(),c),ie={class:"group-management"},de={class:"card-header"},me=ce(()=>v("span",null,"我加入的群组",-1)),pe={class:"dialog-footer"},fe={class:"dialog-footer"},_e=R({__name:"JoinGroup",props:["username"],setup(c){const d=c,p=m(!1),b=m(),s=k({name:"",description:""}),D=k({name:[{required:!0,message:"请输入群组名称",trigger:"blur"}],description:[{required:!0,message:"请输入申请理由",trigger:"blur"}]});m(!1);let I=m(!1),i=m(!1),y=m(!1);const S=k([]),_=m(""),V=k([]),M=te(()=>_.value.length===0?"加入群组":"加入搜索到的群组"),w=m(null);oe(async()=>E());function E(){console.log("showing data"),console.log(d.username),x.post("/group_get_groups_joined",{username:d.username},{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(t){t.data.code===200?S.splice(0,S.length,...t.data.groups):t.data.code===401&&g.error("JG showData "+t.data.message)}).catch(function(){console.log("error submit!")})}function O(t){t&&t.validate(o=>{o?(p.value=!1,x.post("/group_join_forced",{username:d.username,group_name:s.name},{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(f){f.data.code===200?(g.success(f.data.message),_.value?J():E()):g.error("handleSubmit "+f.data.message),s.name="",s.description=""}).catch(function(){console.log("error submit!")})):console.log("error submit!")})}function P(){p.value=!0}function H(){p.value=!1,s.name="",s.description=""}function J(){y.value=!0,V.length=0,x.post("/group_search",{username:d.username,keywords:_.value},{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(t){t.data.code===200?(console.log(t.data),V.splice(0,V.length,...t.data.groups),g.success(t.data.message)):g.error(t.data.message)}).catch(function(){console.log("error search!")})}function L(t){I.value=!0,x.post("/group_quit",{username:d.username,group_name:t.name},{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).then(function(o){o.data.code===200?(g.success(o.data.message),E()):g.error(o.data.message)}).catch(function(){console.log("error delete!")})}function Q(t){s.name=t.name,s.description="",p.value=!0}function W(t){w.value=t,i.value=!0}return(t,o)=>{const f=u("el-table-column"),X=u("el-tag"),Y=u("el-popconfirm"),Z=u("el-table"),ee=u("el-card"),G=u("el-descriptions-item"),ae=u("el-descriptions");return C(),j("div",ie,[e(ee,{class:"group-card"},{header:a(()=>[v("div",de,[me,e(n(h),{type:"primary",onClick:P},{default:a(()=>[r("加入群组")]),_:1})])]),default:a(()=>[e(n(q),{modelValue:_.value,"onUpdate:modelValue":o[0]||(o[0]=l=>_.value=l),placeholder:"搜索群组","prefix-icon":"el-icon-search",clearable:"",class:"search-input",onKeyup:le(J,["enter"])},null,8,["modelValue"]),e(Z,{data:_.value.length===0?S:V,style:{width:"100%"},class:"group-table"},{default:a(()=>[e(f,{label:"群组名称",prop:"name"}),e(f,{label:"创建者",prop:"creator"},{default:a(({row:l})=>[e(X,{size:"small",type:"info"},{default:a(()=>[r($(l.creator),1)]),_:2},1024)]),_:1}),e(f,{label:"人数",prop:"number",width:"80"}),e(f,{label:"操作",align:"center",width:"280"},{default:a(({row:l})=>[e(n(h),{type:"",size:"small",onClick:T=>W(l)},{default:a(()=>[r(" 详情 ")]),_:2},1032,["onClick"]),_.value.length===0?(C(),N(Y,{key:0,title:"确定要退出该群组吗？",onConfirm:T=>L(l)},{reference:a(()=>[e(n(h),{type:"danger",size:"small"},{default:a(()=>[r(" 退出群组 ")]),_:1})]),_:2},1032,["onConfirm"])):(C(),N(n(h),{key:1,type:"primary",size:"small",onClick:T=>Q(l)},{default:a(()=>[r(" 加入群组 ")]),_:2},1032,["onClick"]))]),_:1})]),_:1},8,["data"])]),_:1}),e(n(U),{modelValue:p.value,"onUpdate:modelValue":o[4]||(o[4]=l=>p.value=l),title:M.value,width:"30%"},{footer:a(()=>[v("span",pe,[e(n(h),{onClick:H},{default:a(()=>[r("取 消")]),_:1}),e(n(h),{type:"primary",onClick:o[3]||(o[3]=l=>O(b.value))},{default:a(()=>[r("确 定")]),_:1})])]),default:a(()=>[e(n(se),{ref_key:"formRef",ref:b,model:s,rules:D,"label-width":"80px","status-icon":""},{default:a(()=>[e(n(B),{label:"群组名称",prop:"name"},{default:a(()=>[e(n(q),{modelValue:s.name,"onUpdate:modelValue":o[1]||(o[1]=l=>s.name=l),autocomplete:"off",clearable:""},null,8,["modelValue"])]),_:1}),e(n(B),{label:"申请理由",prop:"description"},{default:a(()=>[e(n(q),{modelValue:s.description,"onUpdate:modelValue":o[2]||(o[2]=l=>s.description=l),type:"textarea",rows:3,placeholder:"请输入申请理由"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"]),e(n(U),{modelValue:n(i),"onUpdate:modelValue":o[6]||(o[6]=l=>z(i)?i.value=l:i=l),title:"群组详情",width:"30%","align-center":""},{footer:a(()=>[v("div",fe,[e(n(h),{onClick:o[5]||(o[5]=l=>z(i)?i.value=!1:i=!1)},{default:a(()=>[r("关闭")]),_:1})])]),default:a(()=>[w.value?(C(),N(ae,{key:0,column:1,border:""},{default:a(()=>[e(G,{label:"群组名称"},{default:a(()=>[r($(w.value.name),1)]),_:1}),e(G,{label:"群主"},{default:a(()=>[r($(w.value.creator),1)]),_:1}),e(G,{label:"描述"},{default:a(()=>[r($(w.value.description||"暂无描述"),1)]),_:1})]),_:1})):ne("",!0)]),_:1},8,["modelValue"])])}}}),ge=K(_e,[["__scopeId","data-v-eb5197d1"]]),he=c=>(A("data-v-a8ea414e"),c=c(),F(),c),ve={class:"common-layout"},be=he(()=>v("i",{class:"el-icon-menu"},null,-1)),ye=R({__name:"GroupJoined",setup(c){const d=m(!1),p=()=>{d.value=!d.value};return(b,s)=>{const D=u("el-button"),I=u("el-header"),i=u("el-main"),y=u("el-container");return C(),j("div",ve,[e(y,null,{default:a(()=>[e(I,null,{default:a(()=>[e(D,{onClick:p,class:"menu-button"},{default:a(()=>[be]),_:1})]),_:1}),e(y,{class:"main-container"},{default:a(()=>[v("div",{class:re(["navigator-overlay",{active:d.value}])},[e(ue,{username:b.$route.query.username},null,8,["username"])],2),e(y,{class:"content-container"},{default:a(()=>[e(i,{class:"shifted-content"},{default:a(()=>[e(ge,{username:b.$route.query.username},null,8,["username"])]),_:1})]),_:1})]),_:1})]),_:1})])}}}),Ve=K(ye,[["__scopeId","data-v-a8ea414e"]]);export{Ve as default};
